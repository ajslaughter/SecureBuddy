<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="CyberShield Buddy" Manufacturer="SecureBuddy" Version="1.0.0.0" UpgradeCode="7f3e2d1c-8a9b-4c5d-be6f-a0b1c2d3e4f5" InstallerVersion="500" Scope="perMachine">
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="CyberShield Buddy" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="ApplicationShortcut" />
      <ComponentRef Id="DesktopShortcut" />
    </Feature>

    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="CyberShield Buddy" />
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="CyberShield Buddy" />
    </StandardDirectory>

    <StandardDirectory Id="DesktopFolder" />

    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="MainExecutable" Guid="b2c3d4e5-f6a7-4890-9123-4567890abcde" Bitness="always64">
        <File Id="CyberShieldBuddyEXE" Source="$(var.CyberShieldBuddy.TargetDir)CyberShieldBuddy.exe" KeyPath="yes" />
      </Component>
      <!-- Add other dependencies if needed, but since it's single file, only the EXE matters -->
    </ComponentGroup>

    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="c3d4e5f6-a7b8-4901-b234-567890abcdef">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="CyberShield Buddy"
                  Description="CyberShield Buddy Security Tool"
                  Target="[INSTALLFOLDER]CyberShieldBuddy.exe"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="AppIcon" />
        <RemoveFolder Id="CleanUpShortCut" Directory="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\SecureBuddy\CyberShieldBuddy" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <Component Id="DesktopShortcut" Guid="d4e5f6a7-b8c9-5012-c345-678901abcdef" Directory="DesktopFolder">
      <Shortcut Id="ApplicationDesktopShortcut"
                Name="CyberShield Buddy"
                Description="CyberShield Buddy Security Tool"
                Target="[INSTALLFOLDER]CyberShieldBuddy.exe"
                WorkingDirectory="INSTALLFOLDER"
                Icon="AppIcon" />
      <RegistryValue Root="HKCU" Key="Software\SecureBuddy\CyberShieldBuddy" Name="desktopShortcut" Type="integer" Value="1" KeyPath="yes" />
    </Component>

    <Icon Id="AppIcon" SourceFile="$(var.CyberShieldBuddy.TargetDir)CyberShieldBuddy.exe" />
  </Package>
</Wix>
